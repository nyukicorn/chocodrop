# XR UI プロトタイプ仕様メモ

## 1. ゴール
- ヘッドセット内で ChocoDrop の生成フォームとログを操作可能にする。
- コントローラ／ハンドトラッキング操作に対応した最低限の UI を提供し、ブラウザ側ダッシュボードに依存しないワークフローを実現する。

## 2. コンポーネント概要
| コンポーネント | 役割 | 実装メモ |
| --- | --- | --- |
| メインパネル | プロンプト入力、サービス選択、実行ボタン | WebXR Layers (Quad Layer) または CSS3DRenderer を利用。幅 1.2m、高さ 0.7m 目安。 |
| ステータスバッジ | リクエスト中／成功／失敗の通知 | SceneManager のイベントを購読し、色（青 / 緑 / 赤）で表現。 |
| アセットギャラリー | 最近生成した画像・動画をサムネイル表示 | 1 列 3 枚表示。選択時にシーンへドラッグ配置。 |
| ログパネル | `chocodrop-dev.log` の抜粋表示 | スクロール可能なテキスト。エラー時は自動で表示をポップ。 |
| コントローラヒント | 操作ガイド (trigger=決定, grip=キャンセル 等) | 初回起動時に表示、以後はメニューから呼び出し。 |

## 3. レイアウト案
```
[ Controller 視点 ]

 ┌────────────────────────────┐
 │     メインパネル（入力フォーム）   │
 │ [テキスト入力] [サービス選択] [実行] │
 └────────────────────────────┘
             ↓1.5m 離隔
 ┌───────────┐ ┌───────────┐
 │ ステータス │ │ ギャラリー │
 └───────────┘ └───────────┘
```
- メインパネルはカメラ前方 1.5m、視線のやや下（Y=1.4m）に配置。
- ステータスは左下、ギャラリーは右下に浮かせる構成。

## 4. インタラクション設計
1. **テキスト入力**: Quest のソフトキーボードを利用。将来的には音声入力（Web Speech API）連携も検討。
2. **ドラッグ配置**: ギャラリーのサムネイルを掴み、シーンにドロップすると SceneManager が配置処理を実行。
3. **UI 呼び出し**: A/B ボタンでメインパネルの表示・非表示を切り替え。グリップで位置調整モードに移行。
4. **ログ閲覧**: エラー発生時に自動でログパネルを前面表示。close すると右側へ格納。

## 5. 実装ステップ
1. `immersive-launcher.js` に XR UI 管理クラス（`XRInterfaceManager` 仮）を追加。
2. WebXR Layer / CSS3DRenderer のどちらかで試作し、パフォーマンス・可読性を比較。
3. SceneManager のイベント（`onGenerateStart`, `onGenerateSuccess`, `onGenerateError`）を XR UI にブリッジ。
4. ギャラリーのドラッグ処理を Raycaster + attach/detach で実装。
5. ログパネルは OPFS から最新 100 行を取得して表示。UX に合わせてページング検討。

## 6. 課題と検討事項
- WebXR Layers はブラウザ実装差があり、フォールバックとして CSS3DRenderer / Mesh UI コンポーネントを用意する。
- テキスト入力 UX（ソフトキーボード vs. VR キーボード）を検証。音声入力も視野に入れる。
- ドラッグ＆ドロップの挙動は物理挙動と競合しやすいため、Raycaster の衝突レイヤーを分ける。
- 多言語対応（日本語 / 英語 UI）の切り替えを早期に設計。

---
次ステップ: モックアップ段階ではテキストベースの UI を優先し、後続でデザイナーと連携してスタイルを調整する。
