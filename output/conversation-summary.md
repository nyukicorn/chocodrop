# ChocoDrop PWA / XR 構想共有メモ（2025-10-31）

## 1. 背景
- ChocoDrop をホームアイコンから即起動できる **PWA 化** と、ワンタップで WebXR セッションに入れる **没入ランチャー** を整備済み。
- 既存のデモページはフォーム UI と Three.js シーンが一体化しているが、プロダクトの理想像は「ユーザー各自の Three.js シーンに ChocoDrop UI を差し込み、そこで画像・動画生成を行う」形。

## 2. 現状実装の位置づけ
- `/index.html`：管理ダッシュボード。Service Worker と OPFS によるキャッシュ・ログ記録・再訪体験を実装し、フォームの値やモデル一覧も保持。
- `/immersive.html`＋`immersive-launcher.js`：没入ビュー。Three.js レンダラー・ライト・グリッドを初期化し、`createChocoDrop` でシーン管理の骨格を構築済み。XR セッションをワンタップで開始可能。
- これらを PWA manifest / Service Worker / import map などを通じてインストール可能・オフライン動作可能な体験に統合。

## 3. 目指せる二つの方向性
1. **自立型（PWA モード）**  
   - ホームアイコン → `/immersive.html` → WebXR セッション、という流れを強化。  
   - XR 空間に ChocoDrop の UI パネルを表示し、ヘッドセット内で直接生成コマンドを扱えるように進化させる。
2. **取り込み型（シーンインポートモード）**  
   - ユーザーが保有する任意の Three.js シーンを `immersive-launcher.js` 等で読み込み、`createChocoDrop` をそのシーンに注入。  
   - 読み込んだシーンを WebXR で表示しながら ChocoDrop UI を使えるようにする。  
   - 設定 UI や OPFS を活用して、読み込むシーンやサービス設定を保存・再利用。

### 開発上のポイント
- 現在の PWA / Service Worker / OPFS の仕組みは両方向で共通利用可能。
- エントリーポイントを分ける（`/immersive.html`：自立型、`/importer.html`（仮）：取り込み型）ことで一つのリポジトリ内で並行開発できる。
- 大きなアーキテクチャ差が出ない限り、プロジェクトを分割する必要はない。

## 4. 今後の検討タスク例
- XR 空間内 UI の実装（フォーム入力やログ表示の 3D パネル化）。
- 取り込み型モードにおけるシーンロード手順（GLTFLoader / ObjectLoader 連携、設定画面の設計）。
- OPFS を使ったシーン設定・接続情報の保存と共有。
- ユーザーテストで両モードの受容性を評価し、優先順位を決める。

---
このメモは 2025-10-31 時点の議論整理です。開発メンバー追加時のオンボーディング資料として活用してください。
